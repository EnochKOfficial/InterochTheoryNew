<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Interoch Numbers Theory — Research Notes</title>
  <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:wght@400;700&amp;family=Crimson+Pro:wght@400;500;700&amp;display=swap" rel="stylesheet" />
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']],
        processEscapes: true,
        tags: 'all',
        tagSide: 'right',
        tagIndent: '0em',
        packages: { '[+]': ['ams','tagformat'] }
      },
      options: { renderActions: { addMenu: [] } },
      chtml: { scale: 1.05 }
    };
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <style>
    #navbar { display: none !important; }

    :root {
      --bg: #ffffff;
      --text: #111827;
      --muted: #6b7280;
      --accent: #7353ff;
      --accent-2: #a38fff;
      --border: #e5e7eb;
      --paper: #fafafa;
      --radius: 14px;
      --btn-bg: rgba(255,255,255,0.6);
      --btn-bg-hover: rgba(115,83,255,0.08);
    }
    [data-theme="dark"] {
      --bg: #0b0b12;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #8f7aff;
      --accent-2: #b7a8ff;
      --border: #1f2937;
      --paper: #0f1020;
      --btn-bg: rgba(255,255,255,0.08);
      --btn-bg-hover: rgba(115,83,255,0.16);
    }

    *, *::before, *::after { box-sizing: border-box; }
    html { scroll-behavior: smooth; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: 'Crimson Pro', serif;
      line-height: 1.7;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      transition: background-color .3s ease, color .3s ease;
    }

    .mobile-bar { position: sticky; top: 0; z-index: 60; display: none; align-items: center; justify-content: space-between; gap: 12px; padding: 10px 14px; background: var(--bg); border-bottom: 1px solid var(--border); }
    .mobile-brand { font-family: 'Instrument Serif', serif; color: var(--accent); font-weight: 700; }
    .mobile-actions { display: flex; gap: 8px; align-items: center; }
    .icon-btn { width: 40px; height: 40px; display: inline-flex; align-items: center; justify-content: center; border-radius: 999px; border: 1px solid var(--border); background: var(--btn-bg); cursor: pointer; color: var(--accent); }
    .icon-btn:hover { background: var(--btn-bg-hover); }
    .icon-btn svg { width: 22px; height: 22px; stroke: currentColor; fill: none; stroke-width: 2; }

    .page { display: grid; grid-template-columns: 280px 1fr; gap: 28px; max-width: 1200px; padding: 32px 20px 80px; margin: 0 auto; transition: color .3s ease, background-color .3s ease; }
    @media (max-width: 1024px) { .page { grid-template-columns: 1fr; padding-top: 16px; } }

    aside.toc { position: sticky; top: 20px; align-self: start; background: rgba(255,255,255,0.7); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); border: 1px solid var(--border); border-radius: var(--radius); box-shadow: 0 6px 20px rgba(0,0,0,0.06); padding: 14px 14px 10px 14px; transition: background-color .3s ease, border-color .3s ease, color .3s ease; }
    [data-theme="dark"] aside.toc { background: rgba(15,16,32,0.6); box-shadow: 0 6px 20px rgba(0,0,0,0.35); }

    .toc .toprow { display: flex; align-items: center; justify-content: space-between; gap: 10px; }
    .toc .brand { font-family: 'Instrument Serif', serif; color: var(--accent); font-weight: 700; font-size: 1.08rem; }

    .toc nav a { display: block; padding: 8px 10px; color: var(--accent); text-decoration: none; border-radius: 10px; font-family: 'Instrument Serif', serif; transition: background .2s ease, transform .2s ease; }
    .toc nav a:hover { background: #f3f4ff; transform: translateX(2px); }
    [data-theme="dark"] .toc nav a:hover { background: rgba(115,83,255,0.12); }
    .toc nav a.active { background: rgba(115,83,255,0.12); font-weight: 700; }

    .toc .toggle-btn { display: none; cursor: pointer; padding: 6px 10px; border-radius: 10px; background: #f7f7ff; border: 1px solid var(--border); }
    @media (max-width: 1024px) { .toc .toggle-btn { display: inline-flex; align-items: center; gap: 8px; } .toc nav { display: none; } .toc nav.open { display: block; } }

    main.content { background: var(--paper); border: 1px solid var(--border); border-radius: var(--radius); padding: 34px 28px; box-shadow: 0 8px 28px rgba(0,0,0,0.05); transition: background-color .3s ease, border-color .3s ease, color .3s ease, box-shadow .3s ease; }
    [data-theme="dark"] main.content { box-shadow: 0 12px 32px rgba(0,0,0,0.45); }

    h1, h2, h3, h4 { font-family: 'Instrument Serif', serif; color: var(--accent); transition: color .3s ease; }
    h1 { font-size: clamp(2rem, 3.6vw, 3rem); line-height: 1.15; margin: 0 0 10px; }
    .subtitle { color: var(--muted); margin: 0 0 18px; font-size: 1.05rem; }

    h2 { display: flex; align-items: center; justify-content: space-between; gap: 10px; margin-top: 42px; margin-bottom: 8px; font-size: clamp(1.4rem, 2.2vw, 1.8rem); }
    h3 { margin-top: 26px; margin-bottom: 6px; font-size: clamp(1.15rem, 1.7vw, 1.35rem); }
    h4 { margin-top: 16px; margin-bottom: 6px; font-size: 1.05rem; }

    .section-label { color: var(--muted); font-weight: 600; letter-spacing: .04em; text-transform: uppercase; font-size: .8rem; margin-top: 36px; margin-bottom: 6px; }

    ul { padding-left: 1.05rem; } li { margin: 6px 0; }

    .callout { background: #ffffff; border: 1px solid var(--border); border-left: 4px solid var(--accent); border-radius: 12px; padding: 14px 16px; margin: 14px 0; transition: background-color .3s ease, border-color .3s ease; }
    [data-theme="dark"] .callout { background: rgba(255,255,255,0.03); }
    .callout .title { font-weight: 700; color: var(--accent); margin-bottom: 6px; }

    .example { background: #f8fafc; border: 1px dashed var(--border); border-radius: 10px; padding: 10px 12px; margin: 8px 0; transition: background-color .3s ease, border-color .3s ease; }
    [data-theme="dark"] .example { background: rgba(255,255,255,0.04); }

    mjx-container[jax="CHTML"][display="true"] { margin: 14px 0 !important; }

    .keyword { color: var(--accent-2); font-weight: 600; }
    .date { color: var(--muted); font-style: italic; font-size: 0.95rem; }

    h2, h3, h4 { scroll-margin-top: 80px; }

    footer { text-align: center; color: var(--muted); font-size: 0.95rem; padding: 22px 10px; margin-top: 30px; border-top: 1px solid var(--border); }

    .listen-btn, .theme-toggle { position: fixed; top: 18px; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; background: var(--btn-bg); border-radius: 50%; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); box-shadow: 0 6px 20px rgba(0,0,0,0.08); cursor: pointer; transition: transform .22s ease, background-color .3s ease; z-index: 50; color: var(--accent); border: 1px solid var(--border); }
    .listen-btn:hover, .theme-toggle:hover { background: var(--btn-bg-hover); transform: translateY(-3px); }
    .listen-btn { right: 18px; }
    .theme-toggle { right: 78px; }
    .listen-btn svg, .theme-toggle svg { width: 26px; height: 26px; stroke: currentColor; fill: none; stroke-width: 2; }

    @media (max-width: 1024px) { .mobile-bar { display: flex; } .listen-btn, .theme-toggle { display: none; } }

    .sec-toggle { background: transparent; border: 1px solid var(--border); color: var(--accent); border-radius: 10px; padding: 4px 8px; font-family: 'Instrument Serif', serif; cursor: pointer; display: inline-flex; align-items: center; gap: 6px; user-select: none; }
    .sec-toggle:hover { background: rgba(115,83,255,0.08); }
    .sec-toggle .label { font-family: 'Instrument Serif', serif; }
    .section-body { transition: opacity .2s ease; }
    section.collapsed .section-body { display: none; }
  </style>
</head>
<body>
  <div class="mobile-bar" id="mobileBar">
    <div class="mobile-brand">Interoch Theory</div>
    <div class="mobile-actions">
      <button class="icon-btn" id="tocToggleTop" aria-controls="tocNav" aria-expanded="false" title="Toggle contents" type="button">
        <svg viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"></polyline></svg>
      </button>
      <button class="icon-btn" id="mobileThemeToggle" title="Toggle dark mode" aria-pressed="false" type="button">
        <svg viewBox="0 0 24 24"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
      </button>
      <button class="icon-btn" id="mobileListenBtn" title="Read Aloud" type="button">
        <svg viewBox="0 0 24 24"><path d="M3 10v4h4l5 5V5L7 10H3z"></path><path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v8.06c1.48-.74 2.5-2.26 2.5-4.03z"></path><path d="M19.07 4.93a9.969 9.969 0 0 1 0 14.14"/></svg>
      </button>
    </div>
  </div>

  <div class="page">
    <aside class="toc" aria-label="Table of contents">
      <div class="toprow">
        <div class="brand">Interoch Theory</div>
        <button class="toggle-btn" id="tocToggle" aria-controls="tocNav" aria-expanded="false" title="Toggle contents" type="button">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><polyline points="6 9 12 15 18 9"></polyline></svg>
        </button>
      </div>
      <nav id="tocNav">
        <a href="#intro">Introduction</a>
        <a href="#definitions">Definitions</a>
        <a href="#types">Core Types</a>
        <a href="#theorems">Axioms &amp; Theorems</a>
        <a href="#advanced">Advanced</a>
        <a href="#applications">Applications</a>
        <a href="#future">Future</a>
        <a href="#research">Recent Research</a>
      </nav>
    </aside>

    <main class="content">
      <header>
        <h1 id="intro">Interoch Numbers Theory: A Comprehensive Framework</h1>
        <p class="subtitle">Exploring integer sets closed under digit-wise operations and their algebraic, recursive and combinatorial properties.</p>
      </header>

      <section aria-labelledby="definitions" id="sec-definitions">
        <div class="section-label">1 · Foundations</div>
        <h2 id="definitions">
          Foundational Definitions
          <button class="sec-toggle" data-target="sec-definitions" aria-controls="sec-definitions" aria-expanded="true" title="Collapse section" type="button">
            <svg width="18" height="18" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"></polyline></svg>
            <span class="label">Collapse</span>
          </button>
        </h2>
        <div class="section-body">
          <p>Let <span class="keyword">d(n)</span> denote the digits of <em>n</em>. An Interoch set <em>S</em> with operation <em>\(\circ\)</em> satisfies the closure condition in Eq. \(\eqref{eq:closure}\).</p>
          <p>\[\label{eq:closure} \forall n \in S,\ \circ\big(d(n)\big)\ \in\ S.\]</p>
          <h3>1.1 Closure (\(\circ\))</h3>
          <p>The operation \(\circ\) ensures no <span class="keyword">escape</span> from the set \(S\).</p>
        </div>
      </section>

      <section aria-labelledby="types" id="sec-types">
        <div class="section-label">2 · Types</div>
        <h2 id="types">
          Core Interoch Sets
          <button class="sec-toggle" data-target="sec-types" aria-controls="sec-types" aria-expanded="true" title="Collapse section" type="button">
            <svg width="18" height="18" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"></polyline></svg>
            <span class="label">Collapse</span>
          </button>
        </h2>
        <div class="section-body">
          <ul>
            <li><strong class="keyword">Addinteroch</strong> — Sum of digits. <div class="example">Example: \(58 \to 5+8=13\).</div></li>
            <li><strong class="keyword">Subinteroch</strong> — Absolute difference of digits. <div class="example">Example: \(94 \to \lvert 9-4\rvert = 5\).</div></li>
            <li><strong class="keyword">Neutinteroch</strong> — Mix of addition and subtraction. <div class="example">Example: \(47 \to (4+7) - \lvert 4-7\rvert = 11 - 3 = 8\).</div></li>
            <li><strong class="keyword">Mulinteroch</strong> — Product of digits (order sensitive). <div class="example">Example: \(81 \to 8\times1=8\).</div></li>
            <li><strong class="keyword">Divinteroch</strong> — Closed under digit division. <div class="example">Example: \(81 \to 8/1=8\).</div></li>
          </ul>
        </div>
      </section>

      <section aria-labelledby="theorems" id="sec-theorems">
        <div class="section-label">3 · Axioms &amp; Properties</div>
        <h2 id="theorems">
          Axiom, Theorems and Properties
          <button class="sec-toggle" data-target="sec-theorems" aria-controls="sec-theorems" aria-expanded="true" title="Collapse section" type="button">
            <svg width="18" height="18" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"></polyline></svg>
            <span class="label">Collapse</span>
          </button>
        </h2>
        <div class="section-body">
          <h3>3.1 Axioms</h3>
          <div class="callout">
            <div class="title">Axiom 1 (Closure Under Digit Operations)</div>
            <p>For any Interoch set \(S\) and operation \(\circ\), see Eq. \(\eqref{eq:closure}\).</p>
            <div class="example">
              <em>Corollaries</em>:
              <ul>
                <li>If \(\circ\) is deterministic (e.g., digit sum), \(S\) is uniquely closed.</li>
                <li>If \(\circ\) is non-deterministic (e.g., signed digit difference), \(S\) must contain all possible outputs.</li>
              </ul>
            </div>
          </div>

          <div class="callout">
            <div class="title">Axiom 2 (Minimality Condition)</div>
            <ol>
              <li>\(S\) is closed under \(\circ\).</li>
              <li>No proper subset of \(S\) satisfies (1).</li>
            </ol>
            <div class="example">Examples: \(\{6, 60\}\) is minimal for Addinteroch. \(\{0\}\) is trivial-minimal for Subinteroch.</div>
          </div>

          <div class="callout">
            <div class="title">Axiom 3 (Operation-Independent Invariance)</div>
            <p>An Interoch set \(S\) may satisfy multiple operations simultaneously (e.g., additive and multiplicative closure).</p>
            <div class="example">Example: \(\{1\}\) is closed under digit sum (\(1\to1\)) and digit product (\(1\to1\)).</div>
          </div>

          <h3>3.2 Minimal and Maximal Sets</h3>
          <p><span class="keyword">Minimal</span>: Smallest non-trivial closed set.</p>
          <div class="example">Example: \(\{6,60\}\) is minimal for Addinteroch.</div>
          <p><span class="keyword">Maximal</span>: Largest possible closed set (often infinite).</p>
          <div class="example">Example: All numbers divisible by 9 for Addinteroch.</div>

          <h3>3.3 Theorem</h3>
          <p>Any Addinteroch set must share a digital root (mod 9); equivalently, Eq. \(\eqref{eq:mod9}\) holds.</p>
          \[ \label{eq:mod9} n \equiv s_9(n) \pmod{9}. \]

          <h3>3.4 Fixed Points and Invariance</h3>
          <ul>
            <li>Single-digit numbers are fixed points for many operations.</li>
            <li><span class="keyword">Non-trivial invariance</span>: \(\{145\}\) for factorial digit sum \((1! + 4! + 5! = 145)\).</li>
          </ul>
        </div>
      </section>

      <section aria-labelledby="advanced" id="sec-advanced">
        <div class="section-label">4 · Advanced Constructs</div>
        <h2 id="advanced">
          Advanced Constructs
          <button class="sec-toggle" data-target="sec-advanced" aria-controls="sec-advanced" aria-expanded="true" title="Collapse section" type="button">
            <svg width="18" height="18" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"></polyline></svg>
            <span class="label">Collapse</span>
          </button>
        </h2>
        <div class="section-body">
          <h3>4.1 Positional Interochs</h3>
          <ul>
            <li><span class="keyword">Swappinteroch</span> — Closed under digit swaps. <span class="example">Example: \(\{13,31\}\).</span></li>
            <li><span class="keyword">Splitinteroch</span> — Operate on grouped digits. <span class="example">Example: \(123 \to 1 + 23 = 24\).</span></li>
          </ul>

          <h3>4.2 Recursive Interochs</h3>
          <ul>
            <li><span class="keyword">Fractalinteroch</span> — Recursive digit sums. <span class="example">Example: \(987 \to 24 \to 6\).</span></li>
            <li><span class="keyword">Loopinteroch</span> — Numbers that cycle back. <span class="example">Example: \(08 \to 0 + 8 = 8\).</span></li>
          </ul>

          <h3>4.3 Compositional Interochs</h3>
          <ul>
            <li><span class="keyword">Multiinteroch</span> — Chains of operations. <span class="example">Example: \(14 \to 1+4=5;\ 5\times2=10\).</span></li>
            <li><span class="keyword">Groupinteroch</span> — Segment then operate. <span class="example">Example: \(1242 \to 12+42=54\).</span></li>
          </ul>

          <h3>4.4 Transformational Interochs</h3>
          <ul>
            <li><span class="keyword">Codeinteroch</span> — Digit shifts. <span class="example">Example: +2 to each digit in \(123 \to 345\).</span></li>
          </ul>
        </div>
      </section>

      <section aria-labelledby="applications" id="sec-applications">
        <div class="section-label">5 · Applications</div>
        <h2 id="applications">
          Applications
          <button class="sec-toggle" data-target="sec-applications" aria-controls="sec-applications" aria-expanded="true" title="Collapse section" type="button">
            <svg width="18" height="18" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"></polyline></svg>
            <span class="label">Collapse</span>
          </button>
        </h2>
        <div class="section-body">
          <h3>5.1 Recreational Mathematics</h3>
          <ul>
            <li><span class="keyword">Puzzle Design</span>: Create interoch-based riddles.</li>
            <li><span class="keyword">Game Mechanics</span>: Board games where moves follow Codeinteroch.</li>
          </ul>

          <h3>5.2 Computational Exploration</h3>
          <p><span class="keyword">Algorithm</span>: In Python:</p>
          <pre><code>def interoch_closure(seed, operation):
    S = set(seed)
    while True:
        new = {operation(n) for n in S}
        if new.issubset(S):
            break
        S.update(new)
    return S
</code></pre>

          <h3>5.3 Cryptographic Potential</h3>
          <p><span class="keyword">Digit-Operation Keys</span>: Use interoch properties for hashing or encoding.</p>
        </div>
      </section>

      <section aria-labelledby="research" id="sec-research">
        <div class="section-label">7 · Notes</div>
        <h2 id="research">
          Recent Research
          <button class="sec-toggle" data-target="sec-research" aria-controls="sec-research" aria-expanded="true" title="Collapse section" type="button">
            <svg width="18" height="18" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"></polyline></svg>
            <span class="label">Collapse</span>
          </button>
        </h2>
        <div class="section-body">
          <div class="date">2025-08-10</div>
          <h3>Fractalinteroch Patterns in Digital Time</h3>
          <p>Repeated <span class="keyword">digit multiplication</span> in clock times leads to cycles within a <span class="keyword">Fractalinteroch</span> structure.</p>
          <p>\[123 \to 1\times2\times3 = 6 \to 6\times(\text{nothing}) = 6\]</p>
        </div>
      </section>

      <footer>Research by Enoch (2024 – Present)</footer>
    </main>
  </div>

  <div class="listen-btn" id="listenBtn" title="Read Aloud">
    <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 10v4h4l5 5V5L7 10H3z"></path><path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v8.06c1.48-.74 2.5-2.26 2.5-4.03z"></path><path d="M19.07 4.93a9.969 9.969 0 0 1 0 14.14"/></svg>
  </div>

  <button class="theme-toggle" id="themeToggle" title="Toggle dark mode" aria-pressed="false">
    <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
  </button>

  <script>
    const rootEl = document.documentElement;
    const themeToggle = document.getElementById('themeToggle');
    const mobileThemeToggle = document.getElementById('mobileThemeToggle');

    function applyTheme(theme) {
      rootEl.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
      const pressed = theme === 'dark';
      if (themeToggle) themeToggle.setAttribute('aria-pressed', pressed);
      if (mobileThemeToggle) mobileThemeToggle.setAttribute('aria-pressed', pressed);
    }
    const storedTheme = localStorage.getItem('theme');
    const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    if (storedTheme) applyTheme(storedTheme); else if (prefersDark) applyTheme('dark');

    function toggleTheme() { applyTheme((rootEl.getAttribute('data-theme') || 'light') === 'light' ? 'dark' : 'light'); }
    if (themeToggle) themeToggle.addEventListener('click', toggleTheme);
    if (mobileThemeToggle) mobileThemeToggle.addEventListener('click', toggleTheme);

    const listenBtn = document.getElementById('listenBtn');
    const mobileListenBtn = document.getElementById('mobileListenBtn');
    let isReading = false; let utterance;
    function toggleReadAloud() {
      if (!isReading) {
        const textContent = document.querySelector('main.content').innerText;
        utterance = new SpeechSynthesisUtterance(textContent);
        const voices = speechSynthesis.getVoices();
        const formalVoice = voices.find(v => v.lang && v.lang.startsWith('en') && v.name && v.name.toLowerCase().includes('serena')) || voices.find(v => v.lang && v.lang.startsWith('en'));
        if (formalVoice) utterance.voice = formalVoice;
        utterance.rate = 0.95;
        speechSynthesis.speak(utterance);
        isReading = true;
      } else { speechSynthesis.cancel(); isReading = false; }
    }
    if (listenBtn) listenBtn.addEventListener('click', toggleReadAloud);
    if (mobileListenBtn) mobileListenBtn.addEventListener('click', toggleReadAloud);

    const tocToggle = document.getElementById('tocToggle');
    const tocToggleTop = document.getElementById('tocToggleTop');
    const tocNav = document.getElementById('tocNav');
    function setTocOpen(open) { tocNav.classList.toggle('open', open); if (tocToggle) tocToggle.setAttribute('aria-expanded', open); if (tocToggleTop) tocToggleTop.setAttribute('aria-expanded', open); }
    if (tocToggle) tocToggle.addEventListener('click', () => setTocOpen(!tocNav.classList.contains('open')));
    if (tocToggleTop) tocToggleTop.addEventListener('click', () => setTocOpen(!tocNav.classList.contains('open')));

    const tocLinks = Array.from(document.querySelectorAll('.toc nav a'));
    const headings = tocLinks.map(a => document.querySelector(a.getAttribute('href'))).filter(Boolean);
    const setActive = (id) => { tocLinks.forEach(l => l.classList.toggle('active', l.getAttribute('href') === '#' + id)); };
    const observer = new IntersectionObserver((entries) => { entries.forEach(entry => { if (entry.isIntersecting) setActive(entry.target.id); }); }, { rootMargin: '0px 0px -60% 0px', threshold: 0.2 });
    headings.forEach(h => observer.observe(h));

    tocLinks.forEach(a => a.addEventListener('click', (e) => { setActive(e.currentTarget.getAttribute('href').slice(1)); }));
    window.addEventListener('scroll', () => { if (window.innerHeight + window.scrollY >= document.body.scrollHeight - 2) setActive('research'); });

    // Collapsibles — per-button robust handler
    function toggleSection(btn) {
      const targetId = btn.getAttribute('data-target');
      const sec = (targetId && document.getElementById(targetId)) || btn.closest('section');
      if (!sec) return;
      const body = sec.querySelector('.section-body');
      const isCollapsed = sec.classList.toggle('collapsed');
      if (body) body.style.opacity = isCollapsed ? '0' : '1';
      btn.setAttribute('aria-expanded', String(!isCollapsed));
      const svg = btn.querySelector('svg');
      if (svg) svg.style.transform = isCollapsed ? 'rotate(180deg)' : 'rotate(0deg)';
      const label = btn.querySelector('.label');
      if (label) label.textContent = isCollapsed ? 'Expand' : 'Collapse';
    }

    document.querySelectorAll('.sec-toggle').forEach(btn => {
      btn.addEventListener('click', () => toggleSection(btn));
      btn.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggleSection(btn); }
      });
    });

    document.addEventListener('DOMContentLoaded', () => { if (window.innerWidth <= 1024) document.getElementById('mobileBar').style.display = 'flex'; });
  </script>
</body>
</html>